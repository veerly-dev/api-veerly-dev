// ENUMS
enum BlogTemplate {
    DEFAULT
    CODE_HEAVY
    QUIZ_INTEGRATED
    MINIMAL
}

// MODELS
model BlogPost {
    id        String       @id @default(uuid())
    title     String
    slug      String       @unique
    summary   String
    content   String // Markdown or HTML
    template  BlogTemplate @default(DEFAULT)
    tags      Tag[]        @relation("BlogTags")
    questions Question[]   @relation("BlogQuestions")
    comments  Comment[]    @relation("BlogComments")
    authorId  String // Google user ID
    createdAt DateTime     @default(now())
    updatedAt DateTime     @updatedAt
}

model Question {
    id             String     @id @default(uuid())
    content        String
    type           String // 'mcq', 'code', 'behavioral'
    difficulty     String // 'easy', 'medium', 'hard'
    options        Option[] // for MCQs
    tags           Tag[]      @relation("QuestionTags")
    answers        Answer[]   @relation("QuestionAnswers")
    activeAnswerId String?    @unique // FK to Answer
    activeAnswer   Answer?    @relation("ActiveAnswer", fields: [activeAnswerId], references: [id])
    blogPosts      BlogPost[] @relation("BlogQuestions")
    createdAt      DateTime   @default(now())
    Answer         Answer?    @relation(fields: [answerId], references: [id])
    answerId       String?
}

model Answer {
    id             String     @id @default(uuid())
    content        String
    explanation    String?
    version        Int
    questionId     String
    question       Question   @relation("QuestionAnswers", fields: [questionId], references: [id])
    createdAt      DateTime   @default(now())
    Question       Question[]
    activeAnswerOf Question?  @relation("ActiveAnswer")
}

model Comment {
    id         String   @id @default(uuid())
    content    String
    authorId   String? // Optional: Google user ID or anonymous
    blogPostId String
    blogPost   BlogPost @relation("BlogComments", fields: [blogPostId], references: [id])
    createdAt  DateTime @default(now())
}

model Tag {
    id        String     @id @default(uuid())
    name      String     @unique
    blogPosts BlogPost[] @relation("BlogTags")
    questions Question[] @relation("QuestionTags")
}

model Option {
    id         String   @id @default(uuid())
    value      String
    questionId String
    question   Question @relation(fields: [questionId], references: [id])
}
